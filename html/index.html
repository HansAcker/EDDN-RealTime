<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<link rel="icon" sizes="any" href="img/activity-icon/activity-icon--state-off.svg" id="icon">
<link rel="preload" href="fonts/orbitron/orbitron-light-webfont.woff" as="font" type="font/woff" crossorigin>
<link rel="modulepreload" href="js/reconnecting-websocket.js">
<link rel="modulepreload" href="js/activity_icon.js">
<link rel="modulepreload" href="js/statsbox.js">
<link rel="modulepreload" href="js/infobox.js">
<link rel="modulepreload" href="js/utils.js">
<link rel="modulepreload" href="js/board.js">
<link rel="stylesheet" href="css/style.css">

<!-- https://github.com/HansAcker/EDDN-RealTime -->
<title>Elite Dangerous Data Network Real Time Feed</title>
<meta name="description" content="Live Events from the Elite Dangerous Data Network">
<meta name="viewport" content="width=device-width, initial-scale=1">

<div id="board">

<div class="table narrow table-jumps">
	<div class="caption">FSD Jumps</div>
	<div class="thead"><div class="cell">FSD Jump</div></div>
	<div class="tbody" id="jumps"></div>
</div>

<div class="table wide table-routes">
	<div class="caption">Routes Plotted</div>
	<div class="thead">
		<div class="cell">Route From</div>
		<div class="cell">To</div>
		<div class="cell">Jumps</div>
		<div class="cell">Distance</div>
		<div class="cell">Total</div>
		<div class="cell">Max</div>
	</div>
	<div class="tbody" id="routes"></div>
</div>

<div class="table narrow table-newstars">
	<div class="caption">Stars discovered</div>
	<div class="thead">
		<div class="cell">Discovered Star</div>
		<div class="cell">Class</div>
	</div>
	<div class="tbody" id="newstars"></div>
</div>

<div class="table wide table-newplanets">
	<div class="caption">Planets discovered</div>
	<div class="thead">
		<div class="cell">Discovered Body</div>
		<div class="cell">Class</div>
		<div class="cell">Atmosphere</div>
		<div class="cell">Landable</div>
	</div>
	<div class="tbody" id="newplanets"></div>
</div>

<div class="table table-scanbods">
	<div class="caption">Scanned Bodies</div>
	<div class="thead">
		<div class="cell">Scanned Body</div>
		<div class="cell">Scan Type</div>
	</div>
	<div class="tbody" id="scanbods"></div>
</div>

<div class="table table-asett">
	<div class="caption">Settlement Approach</div>
	<div class="thead">
		<div class="cell">Settlement Approach</div>
		<div class="cell">System</div>
	</div>
	<div class="tbody" id="asett"></div>
</div>

<div class="table table-docks">
	<div class="caption">Docking and Locations</div>
	<div class="thead">
		<div class="cell">Docked At</div>
		<div class="cell">Type</div>
		<div class="cell">System</div>
	</div>
	<div class="tbody" id="docks"></div>
</div>

<div class="table table-updates">
	<div class="caption">Tables updated</div>
	<div class="thead">
		<div class="cell">Updated</div>
		<div class="cell">Station</div>
		<div class="cell">System</div>
	</div>
	<div class="tbody" id="updates"></div>
</div>

<div class="table wider table-visits">
	<div class="caption">Jumps to inhabited systems</div>
	<div class="thead">
		<div class="cell">System Visited</div>
		<div class="cell">Population</div>
		<div class="cell">Allegiance</div>
		<div class="cell">Faction</div>
		<div class="cell">State</div>
	</div>
	<div class="tbody" id="visits"></div>
</div>

<div class="table wider table-codex">
	<div class="caption">Codex Discoveries</div>
	<div class="thead">
		<div class="cell">System</div>
		<div class="cell">Body</div>
		<div class="cell">Codex Category</div>
		<div class="cell">Type</div>
		<div class="cell">Region</div>
	</div>
	<div class="tbody" id="codex"></div>
</div>

<div class="table table-stats">
	<div class="caption">Stats</div>
	<div class="thead">
		<div class="cell">Stats</div>
		<div class="cell">Count</div>
	</div>
	<div class="tbody" id="statsbody"></div>
</div>

<div class="table table-events">
	<div class="caption">Event Stats</div>
	<div class="thead">
		<div class="cell">Event</div>
		<div class="cell">Count</div>
	</div>
	<div class="tbody" id="eventsbody"></div>
</div>

<div class="table table-events">
	<div class="caption">Software Stats</div>
	<div class="thead">
		<div class="cell">Software</div>
		<div class="cell">Count</div>
	</div>
	<div class="tbody" id="softbody"></div>
</div>

<div class="table table-legend">
	<div class="caption">Legend</div>
	<div class="thead">
		<div class="cell">Legend</div>
	</div>
	<div class="tbody">
		<div class="row Odyssey"><div class="cell">Odyssey</div></div>
		<div class="row Horizons"><div class="cell">Horizons</div></div>
		<div class="row Legacy"><div class="cell">Legacy</div></div>
		<div class="row Base"><div class="cell">A bug (Live but not Horizons)</div></div>
		<div class="row Unknown"><div class="cell">Unknown</div></div>
		<div class="row Odyssey taxi"><div class="cell">Taxi (Apex/Frontline)</div></div>
		<div class="row Odyssey old"><div class="cell">Older than 1h</div></div>
		<div class="row Odyssey new"><div class="cell">In the future</div></div>
	</div>
</div>

</div>

<template id="infotemplate">
<div class="infobox">
	<div class="infobox__header">
		<button class="infobox__button infobox__button--copy-msg" data-infobox__action="copy-msg">Copy message</button>
		<button class="infobox__button infobox__button--copy-gts" data-infobox__action="copy-gts">Copy gateway timestamp</button>
		<button class="infobox__button infobox__button--copy-uid" data-infobox__action="copy-uid">Copy uploader ID</button>
		<button class="infobox__button infobox__button--close" data-infobox__action="close">Close window</button>
	</div>
	<div class="infobox__contentbox">
		<pre class="infobox__content"></pre>
	</div>
</div>
</template>

<script>
"use strict";

const socketUrl = "wss://ws.eddn-realtime.space/eddn";
const listLength = 20;

const idleTimeout = 2300;
const resetTimeout = 300000;

// set th title attributes
for (const cell of window.board.querySelectorAll(".thead .cell")) {
	cell.title = cell.textContent;
}

// fill tables with listLength * empty rows
// TODO: use style?
{
	const tbHTML = '<div class="row"><div class="cell">&nbsp;</div></div>'.repeat(listLength);
	for (const tb of window.board.querySelectorAll(".tbody")) {
		if (!tb.childElementCount) {
			tb.innerHTML = tbHTML;
		}
	}
}
</script>
<script type="module" src="js/board.js"></script>
